\section{Execution Semantics}

Let the device be modeled as a deterministic state machine:

\[
D = (S, C, E, \delta)
\]

where:
\begin{itemize}
\item \\$ is the set of internal device states
\item \\$ is the set of valid commands
\item \\$ is the set of execution effects
\item \$\delta : S \times C \rightarrow S \times E\$ is the execution function
\end{itemize}

\subsection{Execution Rule}

Given a command \ \in C\$ and state \ \in S\$, execution produces:

\[
(s', e) = \delta(s, c)
\]

A receipt is generated if and only if execution occurs.

\subsection{Receipt Definition}

A receipt is defined as:

\[
r = \text{Sign}_{sk_D}(H(c \parallel s \parallel s' \parallel e))
\]

\subsection{Receipt Validity}

A receipt \\$ is valid if:
\begin{itemize}
\item The signature verifies under \\$
\item The hash binds execution inputs and outputs
\item The state transition is valid
\end{itemize}

\subsection{Safety Lemma}

Receipt forgery without execution implies compromise of the device secret key.

\textbf{Therefore, receipt forgery is equivalent to device compromise.}
